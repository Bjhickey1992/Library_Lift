# Dashboard Data Sources & Layout Explanation

## Current Dashboard Layout

The dashboard is organized into 5 main cards:

### 1. **CURRENT CINEMA TRENDS** (Top Left)
**Current Status:** ⚠️ **ALL PLACEHOLDER DATA**

**What's shown:**
- Two movie poster placeholders ("NOW SHOWING" and "RE-RELEASE HIT")
- Trending Genres with hardcoded percentages:
  - Horror: +68%
  - Sci-Fi: +52%
  - Comedy: +35%

**Where data SHOULD come from:**
- `exhibitions_df` - Contains upcoming cinema screenings with:
  - `title`, `genres`, `start_date`, `end_date`, `country`, `location`
  - `tmdb_id` (for poster images)
- Can calculate trending genres by analyzing genre frequency in exhibitions
- Can identify "NOW SHOWING" vs "RE-RELEASE" by comparing `release_year` to current date

**How to connect real data:**
```python
# Analyze exhibitions_df to get trending genres
if exhibitions_df is not None:
    # Count genres from exhibitions
    all_genres = exhibitions_df['genres'].str.split(',').explode().str.strip()
    genre_counts = all_genres.value_counts()
    
    # Calculate percentage changes (would need historical data for real trends)
    # For now, can show current genre distribution
    
    # Get current/recent exhibitions for posters
    current_exhibitions = exhibitions_df[
        (exhibitions_df['start_date'] <= today) & 
        (exhibitions_df['end_date'] >= today)
    ]
```

---

### 2. **TOP RECOMMENDATIONS** (Top Middle)
**Current Status:** ✅ **PARTIALLY REAL DATA**

**What's shown:**
- List of 4 recommended films with thumbnails
- Each shows: Title, Year, Matched Exhibition, "RECOMMENDED FOR VOD" tag

**Where data comes from:**
- `recent_recs` - Generated by calling:
  ```python
  agent.get_recommendations_for_query(
      "What library titles should we emphasize this month in the US?",
      min_similarity=0.5,
      max_similarity=0.7,
      top_n=4
  )
  ```
- This uses real matching algorithm comparing library films to exhibition schedules
- Falls back to placeholder data if no recommendations found

**Data flow:**
1. Loads `library_df` and `exhibitions_df` from Excel files
2. Loads pre-computed embeddings (`.npy` files)
3. Uses semantic similarity matching to find library titles similar to what's showing
4. Returns recommendations with similarity scores

---

### 3. **OTT TREND ANALYSIS** (Top Right)
**Current Status:** ⚠️ **ALL PLACEHOLDER DATA**

**What's shown:**
- Hardcoded platform trends:
  - Netflix: "#1 Rising Horror Picks"
  - IMDb: "Top Sci-Fi Searches"
  - Google Trends: "80s Movies Surge"

**Where data SHOULD come from:**
- **Not currently implemented** - Would need:
  - External API integrations (Netflix API, IMDb API, Google Trends API)
  - Web scraping of OTT platforms
  - Social media trend analysis
  - This is **future functionality** - not part of current codebase

**Potential implementation:**
- Could analyze `library_df` genres against known OTT trends
- Could use TMDB API to get popularity scores
- Would require new data sources/APIs

---

### 4. **REAL-TIME DATA FEEDS** (Bottom Left)
**Current Status:** ⚠️ **ALL PLACEHOLDER DATA**

**What's shown:**
- Hardcoded metrics:
  - IMDb: "48K Mentions"
  - JustWatch: "Sci-Fi Rentals Up 62%"
  - Twitter: "125K #TimeTravel"
  - Variety News: "Horror Films in Demand"

**Where data SHOULD come from:**
- **Not currently implemented** - Would need:
  - IMDb API for mention counts
  - JustWatch API for rental data
  - Twitter API for hashtag trends
  - News API for Variety articles
  - This is **future functionality** - not part of current codebase

**Potential implementation:**
- Could scrape public APIs if available
- Would require API keys and rate limiting
- Could use web scraping as fallback

---

### 5. **CATALOG MATCH OVERVIEW** (Bottom Right)
**Current Status:** ⚠️ **ALL PLACEHOLDER DATA**

**What's shown:**
- Hardcoded metrics:
  - "12 Titles Identified" (Top VOD Opportunities)
  - "High ROI Potential: $215%"
  - "License Availability: Ready for OTT Pitch"

**Where data SHOULD come from:**
- Can be calculated from `recent_recs`:
  ```python
  vod_opportunities = len(recent_recs)  # Number of matched titles
  # ROI would need historical sales data (not available)
  # License availability would need rights database (not available)
  ```

**What CAN be implemented:**
- Count of matched titles: ✅ Can use `len(recent_recs)`
- Average similarity score: ✅ Can calculate from recommendations
- Territory breakdown: ✅ Can analyze by country

**What CANNOT be implemented (without additional data):**
- ROI percentages: ❌ Need historical sales/licensing data
- License availability: ❌ Need rights management database
- Revenue projections: ❌ Need market data

---

## Data Flow Summary

### Available Data Sources:

1. **`library_df`** (from `lionsgate_library.xlsx`)
   - Studio's film library
   - Columns: title, year, director, genres, cast, tmdb_id, etc.
   - Generated by: `run_phase1.py`

2. **`exhibitions_df`** (from `upcoming_exhibitions.xlsx`)
   - Upcoming cinema screenings
   - Columns: title, genres, country, location, start_date, end_date, tmdb_id, etc.
   - Generated by: `run_phase2_exhibitions.py`
   - Scraped from: Cinema websites listed in `cinemas.yaml`

3. **`recent_recs`** (from matching algorithm)
   - Recommendations matching library to exhibitions
   - Generated by: `ChatbotAgent.get_recommendations_for_query()`
   - Uses: Pre-computed embeddings + semantic similarity

### Data Generation Process:

```
Phase 1: Build Library
├── run_phase1.py
├── Fetches films from TMDB API
├── Enriches with metadata
└── Saves to: lionsgate_library.xlsx + embeddings.npy

Phase 2: Scrape Exhibitions  
├── run_phase2_exhibitions.py
├── Scrapes cinema websites (cinemas.yaml)
├── Enriches with TMDB metadata
└── Saves to: upcoming_exhibitions.xlsx + embeddings.npy

Phase 3: Generate Matches
├── run_phase3_matching.py
├── Uses embeddings for similarity matching
└── Creates match recommendations

Dashboard:
├── Loads library_df and exhibitions_df
├── Uses ChatbotAgent for recommendations
└── Displays results (or placeholders if data missing)
```

---

## Recommendations for Connecting Real Data

### Quick Wins (Can implement now):

1. **Trending Genres** - Analyze `exhibitions_df['genres']`:
   ```python
   # Count genre frequency in current exhibitions
   genre_counts = exhibitions_df['genres'].str.split(',').explode().str.strip().value_counts()
   # Show top 3 genres
   ```

2. **Current Cinema Posters** - Use `tmdb_id` from exhibitions:
   ```python
   # Get poster URLs from TMDB
   # Use agent.tmdb_client to fetch poster images
   ```

3. **VOD Opportunities Count** - Use `len(recent_recs)`:
   ```python
   vod_count = len(recent_recs) if recent_recs else 0
   ```

### Future Enhancements (Require new data sources):

1. **OTT Trends** - Need API integrations
2. **Real-time Feeds** - Need external APIs
3. **ROI Metrics** - Need historical sales data
4. **License Availability** - Need rights database

---

## Current Implementation Status

| Dashboard Section | Data Source | Status |
|------------------|-------------|--------|
| Cinema Trends (Posters) | exhibitions_df | ❌ Placeholder |
| Cinema Trends (Genres) | exhibitions_df | ❌ Placeholder |
| Top Recommendations | recent_recs | ✅ Real Data |
| OTT Trends | N/A | ❌ Placeholder |
| Real-time Feeds | N/A | ❌ Placeholder |
| Catalog Match Count | recent_recs | ⚠️ Can implement |
| ROI Metrics | N/A | ❌ Placeholder |
| License Status | N/A | ❌ Placeholder |

---

## Next Steps

To make the dashboard show real data:

1. **Run data generation scripts:**
   ```bash
   python run_phase1.py          # Build library
   python run_phase2_exhibitions.py  # Scrape exhibitions
   python run_phase3_matching.py     # Generate matches
   ```

2. **Update dashboard code** to:
   - Calculate trending genres from exhibitions_df
   - Fetch poster images using tmdb_id
   - Show real recommendation counts
   - Display actual matched titles

3. **For future features:**
   - Integrate external APIs for OTT trends
   - Add web scraping for real-time feeds
   - Connect to rights management system for license data
